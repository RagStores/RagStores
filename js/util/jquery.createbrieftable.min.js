jQuery(document).ready(function(t){var e,a=0,d=0,s=function(d,s){if(d){let a="",d=t("<tr>").addClass("dataRow"),s=t("#txtRefine").val(),n=JSON.parse(t("#txtItens").val()),r=t("#txtCards").val(),p=t("#txtEnchants").val(),c=t("#txtQtd").val(),o=t("#txtPrice").val();t("#divBrief #txtBrief").val()||(a="[{"),s?(d.append(t("<td>").addClass("inputValue").addClass("txtRefineRow").text(s)),a+='"txtRefine": "'+s+'"'):(d.append(t("<td>").addClass("inputValue").addClass("txtRefineRow").text("-")),a+='"txtRefine": "-"'),d.append(t("<td style='display: none;'>").addClass("inputValue").text(n[0].id)),d.append(t("<td><img src='https://static.divine-pride.net/images/items/item/"+n[0].id+".png' alt='"+n[0].name+"' width='auto' height='auto' style='margin-right: -2px;'></td>")),d.append(t("<td class='inputValue'><a href='https://www.divine-pride.net/database/item/"+n[0].id+"' target='_blank'>"+n[0].name+"</a></td>")),a+=',"txtItensId": "'+n[0].id+'"',a+=',"txtItensName": "'+n[0].name+'"',r?(d.append(t("<td style='white-space: pre;'>").addClass("inputValue").addClass("txtCardsRow").text(r.replace(/,/g,"\n"))),a+=',"txtCards": "'+r.replace(/,/g,"*")+'"'):(d.append(t("<td>").addClass("inputValue").addClass("txtCardsRow").text("-")),a+=',"txtCards": "-"'),p?(d.append(t("<td style='white-space: pre;'>").addClass("inputValue").addClass("txtEnchantsRow").text(p.replace(/,/g,"\n"))),a+=',"txtEnchants": "'+p.replace(/,/g,"*")+'"'):(d.append(t("<td>").addClass("inputValue").addClass("txtEnchantsRow").text("-")),a+=',"txtEnchants": "-"'),d.append(t("<td>").addClass("inputValue").addClass("txtQtdRow").text(c+" un")),a+=',"txtQtd": "'+c+' un"';let x=l(o);if(d.append(t("<td>").addClass("inputValue").addClass("txtPriceRow").text(x+" Z")),a+=',"txtPrice": "'+x+' Z"',d.append(t("<td>").addClass("rowActionButtons").append("<a href='javascript:void(0);' class='btnActionEditRow'><i class='fas fa-pencil-alt'></i></a> <a href='javascript:void(0);' class='btnActionDeleteRow'><i class='fas fa-trash-alt'></i></a>")),t("#tbBrief").append(d),t("#divBrief #txtBrief").val()){let e="[";JSON.parse(t("#divBrief #txtBrief").val()).forEach(function(t,a){e+='{"txtRefine": "'+t.txtRefine+'"',e+=',"txtItensId": "'+t.txtItensId+'"',e+=',"txtItensName": "'+t.txtItensName+'"',e+=',"txtCards": "'+t.txtCards+'"',e+=',"txtEnchants": "'+t.txtEnchants+'"',e+=',"txtQtd": "'+t.txtQtd+'"',e+=',"txtPrice": "'+t.txtPrice+'"},'}),a=e+"{"+a+"}]"}else a+="}]";e=JSON.parse(a),i(a)}else{e=JSON.parse(s),i(s),t("#tbBrief tr.dataRow").remove();for(let d=0;d<a;d++){let a=t("<tr>").addClass("dataRow");a.append(t("<td>").addClass("inputValue").addClass("txtRefineRow").text(e[d].txtRefine)),a.append(t("<td style='display: none;'>").addClass("inputValue").text(e[d].txtItensId)),a.append(t("<td><img src='https://static.divine-pride.net/images/items/item/"+e[d].txtItensId+".png' alt='"+e[d].txtItensName+"' width='auto' height='auto' style='margin-right: -2px;'></td>")),a.append(t("<td class='inputValue'><a href='https://www.divine-pride.net/database/item/"+e[d].txtItensId+"' target='_blank'>"+e[d].txtItensName+"</a></td>")),a.append(t("<td style='white-space: pre;'>").addClass("inputValue").addClass("txtCardsRow").text(e[d].txtCards.replaceAll("*","<br>"))),a.append(t("<td style='white-space: pre;'>").addClass("inputValue").addClass("txtEnchantsRow").text(e[d].txtEnchants.replaceAll("*","<br>"))),a.append(t("<td>").addClass("inputValue").addClass("txtQtdRow").text(e[d].txtQtd)),a.append(t("<td>").addClass("inputValue").addClass("txtPriceRow").text(e[d].txtPrice)),a.append(t("<td>").addClass("rowActionButtons").append("<a href='javascript:void(0);' class='btnActionEditRow'><i class='fas fa-pencil-alt'></i></a> <a href='javascript:void(0);' class='btnActionDeleteRow'><i class='fas fa-trash-alt'></i></a>")),t("#tbBrief").append(a)}}},i=function(e){t("#divBrief #txtBrief").remove(),t("#divBrief").append("<input type='text' id='txtBrief' name='txtBrief' autocomplete='off' tabindex='-1' style='position: absolute; top: -14000px; left: -14000px;'>"),t("#divBrief #txtBrief").val(e),t("#divBrief #txtSendBrief").remove(),t("#divBrief").append("<input type='text' id='txtSendBrief' name='txtSendBrief' autocomplete='off' tabindex='-1' style='position: absolute; top: -14000px; left: -14000px;' value='"+e.replace(/"/g,"&quot;")+"'>")},n=function(){t("#txtRefine").val(""),t(".step-three .item-one li").css("display",""),t("#txtItens").val(""),t(".step-three .item-two li").css("display",""),t("#txtCards").val(""),t(".step-three .item-three li").css("display",""),t("#txtEnchants").val(""),t(".step-three .item-four li").css("display",""),t("#txtQtd").val(""),t(".step-three .item-five li").css("display",""),t("#txtPrice").val(""),t(".step-three .item-six li").css("display","")},l=function(t){return t.length>3&&(t.length>4&&(t.length>5&&(t.length>6&&(t.length>7&&(t.length>8&&(t.length>9&&(t.length>10&&(t=t.replace(/^(\d{2})(\d{3})(\d{3})(\d{3}).*/,"$1,$2,$3,$4")),t=t.replace(/^(\d{1})(\d{3})(\d{3})(\d{3}).*/,"$1,$2,$3,$4")),t=t.replace(/^(\d{3})(\d{3})(\d{3}).*/,"$1,$2,$3")),t=t.replace(/^(\d{2})(\d{3})(\d{3}).*/,"$1,$2,$3")),t=t.replace(/^(\d{1})(\d{3})(\d{3}).*/,"$1,$2,$3")),t=t.replace(/^(\d{3})(\d{3}).*/,"$1,$2")),t=t.replace(/^(\d{2})(\d{3}).*/,"$1,$2")),t=t.replace(/^(\d{1})(\d{3}).*/,"$1,$2")),t};t("#btnAddItem").click(function(e){t(".step-three #hint-error").addClass("hide"),t("#txtItens").val()&&t("#txtQtd").val()&&t("#txtPrice").val()&&a<12?(e.preventDefault(),a++,s(!0),n()):(e.preventDefault(),t("#txtItens").val()||t(".step-three .item-two li").addClass("has-error is-focused"),t("#txtQtd").val()||t(".step-three .item-five li").addClass("has-error is-focused"),t("#txtPrice").val()||t(".step-three .item-six li").addClass("has-error is-focused"))}),t(document).on("click","#btnEditItem",function(a){if(t(".step-three #hint-error").addClass("hide"),t("#txtQtd").val()&&t("#txtPrice").val()){a.preventDefault();let p="",c="",o="",x="",u="";p=t("#txtRefine").val()?t("#txtRefine").val():"-",c=t("#txtCards").val()?t("#txtCards").val():"-",o=t("#txtEnchants").val()?t("#txtEnchants").val():"-",x=t("#txtQtd").val()?t("#txtQtd").val():"-",u=t("#txtPrice").val()?t("#txtPrice").val():"-",e=function(t,e,a,d,s,i,n,r,p){return t[e].txtRefine=a,t[e].txtCards=d.replace(/,/g,"*"),t[e].txtEnchants=s.replace(/,/g,"*"),t[e].txtQtd=i+" un",t[e].txtPrice=l(n)+" Z",void 0===r||(t[e].txtItensId=r),void 0===p||(t[e].txtItensName=p),t}(e,d,p,c,o,x,u),n(),i(JSON.stringify(e)),t("div.steps.step-three div.union-group.item-two.form-group ul li").removeClass("hide"),t("div.steps.step-three div.union-group.item-two.form-group ul .editItem").remove(),t("#btnEditItem").remove(),t("#btnAddItem").removeClass("hide"),t("td.rowActionButtons").append("<a href='javascript:void(0);' class='btnActionDeleteRow'><i class='fas fa-trash-alt'></i></a>"),s=e,t("#tbBrief tr:nth-child("+((r=d)+2)+") td:nth-child(1)").empty().append(s[r].txtRefine),t("#tbBrief tr:nth-child("+(r+2)+") td:nth-child(5)").empty().append(s[r].txtCards.replaceAll("*","<br>")),t("#tbBrief tr:nth-child("+(r+2)+") td:nth-child(6)").empty().append(s[r].txtEnchants.replaceAll("*","<br>")),t("#tbBrief tr:nth-child("+(r+2)+") td:nth-child(7)").empty().append(s[r].txtQtd),t("#tbBrief tr:nth-child("+(r+2)+") td:nth-child(8)").empty().append(s[r].txtPrice)}else a.preventDefault(),t("#txtQtd").val()||t(".step-three .item-five li").addClass("has-error is-focused"),t("#txtPrice").val()||t(".step-three .item-six li").addClass("has-error is-focused");var s,r}),t(document).on("click","a.btnActionEditRow",function(){d=t(this).closest("tr").index()-1,t("div.steps.step-three div.union-group.item-two.form-group ul li").addClass("hide"),t("div.steps.step-three div.union-group.item-two.form-group ul .editItem").remove(),t("div.steps.step-three div.union-group.item-two.form-group ul").append("<li class='value editItem'><span class='text'>"+e[d].txtItensName+"</span></li>"),t("#txtQtd").val(e[d].txtQtd.replace(" un","")),t("#txtPrice").val(e[d].txtPrice.replace(" Z","").replace(/,/g,"")),"-"!=e[d].txtRefine&&t("#txtRefine").val(e[d].txtRefine),"-"!=e[d].txtCards&&t("#txtCards").val(e[d].txtCards.replace("*",", ")),"-"!=e[d].txtEnchants&&t("#txtEnchants").val(e[d].txtEnchants.replace("*",", ")),t("#btnAddItem").addClass("hide"),t("a.btnActionDeleteRow").remove(),t("#btnEditItem").length||t("div #actionButtons").append('<button id="btnEditItem" class="sale-button wprc-submit sale-button-edit" type="button">Editar</button>')}),t(document).on("click","a.btnActionDeleteRow",function(){d=t(this).closest("tr").index()-1,a--,delete e[d];let i=JSON.stringify(e.filter(function(t){return"object"!=typeof t||Array.isArray(t)||Object.keys(t).length>0}));s(!1,i)})});