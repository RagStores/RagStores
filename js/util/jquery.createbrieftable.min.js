jQuery(document).ready(function(t){var e,a=0,d=0,i=function(d,i){let l=!1;if(d){let a="",i=t("<tr>").addClass("dataRow"),l=t("#txtRefine").val(),o=JSON.parse(t("#txtItens").val()),p=t("#txtCards").val(),c=t("#txtEnchants").val(),f=t("#txtQtd").val(),x=t("#txtPrice").val();t("#divBrief #txtBrief").val()||(a="[{"),l?(i.append(t("<td>").addClass("inputValue").addClass("txtRefineRow").text(l)),a+='"txtRefine": "'+l+'"'):(i.append(t("<td>").addClass("inputValue").addClass("txtRefineRow").text("-")),a+='"txtRefine": "-"'),i.append(t("<td style='display: none;'>").addClass("inputValue").text(o[0].id)),i.append(t("<td><img src='https://static.divine-pride.net/images/items/item/"+o[0].id+".png' alt='"+o[0].name+"' width='auto' height='auto' style='margin-right: -2px;'></td>")),i.append(t("<td class='inputValue'><a href='/search/"+o[0].id+"' target='_blank'>"+o[0].name+"</a></td>")),a+=',"txtItensId": "'+o[0].id+'"',a+=',"txtItensName": "'+o[0].name+'"',p?(i.append(t("<td style='white-space: pre;'>").addClass("inputValue").addClass("txtCardsRow").text(p.replace(/,/g,"\n"))),a+=',"txtCards": "'+p.replace(/,/g,"*")+'"'):(i.append(t("<td>").addClass("inputValue").addClass("txtCardsRow").text("-")),a+=',"txtCards": "-"'),c?(i.append(t("<td style='white-space: pre;'>").addClass("inputValue").addClass("txtEnchantsRow").text(c.replace(/,/g,"\n"))),a+=',"txtEnchants": "'+c.replace(/,/g,"*")+'"'):(i.append(t("<td>").addClass("inputValue").addClass("txtEnchantsRow").text("-")),a+=',"txtEnchants": "-"'),i.append(t("<td>").addClass("inputValue").addClass("txtQtdRow").text(f+" un")),a+=',"txtQtd": "'+f+' un"';let h=n(x);i.append(t("<td>").addClass("inputValue").addClass("txtPriceRow").text(h+" Z")),a+=',"txtPrice": "'+h+' Z"',a+=',"offer": true, "sold": false',i.append(t("<td>").addClass("rowActionButtons").append("<a href='javascript:void(0);' class='btnActionEditRow'><i class='fas fa-pencil-alt'></i></a> <a href='javascript:void(0);' class='btnActionDeleteRow'><i class='fas fa-trash-alt'></i></a>")),t("#tbBrief").append(i),t("#divBrief #txtBrief").val()?r(a,d):(a+="}]",e=JSON.parse(a),s(a))}else{e=JSON.parse(i),s(i),t("#tbBrief tr.dataRow").remove();for(let d=0;d<a;d++){let a=t("<tr>").addClass("dataRow");a.append(t("<td>").addClass("inputValue").addClass("txtRefineRow").text(e[d].txtRefine)),a.append(t("<td style='display: none;'>").addClass("inputValue").text(e[d].txtItensId)),a.append(t("<td><img src='https://static.divine-pride.net/images/items/item/"+e[d].txtItensId+".png' alt='"+e[d].txtItensName+"' width='auto' height='auto' style='margin-right: -2px;'></td>")),a.append(t("<td class='inputValue'><a href='/search/"+e[d].txtItensId+"' target='_blank'>"+e[d].txtItensName+"</a></td>")),a.append(t("<td style='white-space: pre;'>").addClass("inputValue").addClass("txtCardsRow").text(e[d].txtCards.replaceAll("*","\n"))),a.append(t("<td style='white-space: pre;'>").addClass("inputValue").addClass("txtEnchantsRow").text(e[d].txtEnchants.replaceAll("*","\n"))),a.append(t("<td>").addClass("inputValue").addClass("txtQtdRow").text(e[d].txtQtd)),a.append(t("<td>").addClass("inputValue").addClass("txtPriceRow").text(e[d].txtPrice)),a.append(t("<td>").addClass("rowActionButtons").append("<a href='javascript:void(0);' class='btnActionEditRow'><i class='fas fa-pencil-alt'></i></a> <a href='javascript:void(0);' class='btnActionDeleteRow'><i class='fas fa-trash-alt'></i></a>")),e[d].hasOwnProperty("offer")||(l=!0),t("#tbBrief").append(a)}l&&r(i,d)}},s=function(e,a){void 0===a?(t("#divBrief #txtBrief").remove(),t("#divBrief").append("<input type='text' id='txtBrief' name='txtBrief' autocomplete='off' tabindex='-1' style='position: absolute; top: -14000px; left: -14000px;'>"),t("#divBrief #txtBrief").val(e),t("#divBrief #txtSendBrief").remove(),t("#divBrief").append("<input type='text' id='txtSendBrief' name='txtSendBrief' autocomplete='off' tabindex='-1' style='position: absolute; top: -14000px; left: -14000px;' value='"+e.replace(/"/g,"&quot;")+"'>")):(t("#divBrief #txtSendBrief"+a).val()&&t("#divBrief #txtSendBrief"+a).remove(),t("#divBrief").append("<input type='text' id='txtSendBrief"+a+"' name='txtSendBrief"+a+"' autocomplete='off' tabindex='-1' style='position: absolute; top: -14000px; left: -14000px;' value='"+e.replace(/"/g,"&quot;")+"'>"))},r=function(a,d){let i="[";JSON.parse(t("#divBrief #txtBrief").val()).forEach(function(t,e){i+='{"txtRefine": "'+t.txtRefine+'"',i+=',"txtItensId": "'+t.txtItensId+'"',i+=',"txtItensName": "'+t.txtItensName+'"',i+=',"txtCards": "'+t.txtCards+'"',i+=',"txtEnchants": "'+t.txtEnchants+'"',i+=',"txtQtd": "'+t.txtQtd+'"',i+=',"txtPrice": "'+t.txtPrice+'"',i+=',"offer": true',i+=',"sold": false },'}),a=d?i+"{"+a+"}]":(i+",]").replace(/,,/g,""),e=JSON.parse(a),s(a)},l=function(){t("#txtRefine").val(""),t(".step-three .item-one li").css("display",""),t("#txtItens").val(""),t(".step-three .item-two li").css("display",""),t("#txtCards").val(""),t(".step-three .item-three li").css("display",""),t("#txtEnchants").val(""),t(".step-three .item-four li").css("display",""),t("#txtQtd").val(""),t(".step-three .item-five li").css("display",""),t("#txtPrice").val(""),t(".step-three .item-six li").css("display",""),t("#txtSavedTableItem").val("")},n=function(t){return t.length>3&&(t.length>4&&(t.length>5&&(t.length>6&&(t.length>7&&(t.length>8&&(t.length>9&&(t.length>10&&(t=t.replace(/^(\d{2})(\d{3})(\d{3})(\d{3}).*/,"$1,$2,$3,$4")),t=t.replace(/^(\d{1})(\d{3})(\d{3})(\d{3}).*/,"$1,$2,$3,$4")),t=t.replace(/^(\d{3})(\d{3})(\d{3}).*/,"$1,$2,$3")),t=t.replace(/^(\d{2})(\d{3})(\d{3}).*/,"$1,$2,$3")),t=t.replace(/^(\d{1})(\d{3})(\d{3}).*/,"$1,$2,$3")),t=t.replace(/^(\d{3})(\d{3}).*/,"$1,$2")),t=t.replace(/^(\d{2})(\d{3}).*/,"$1,$2")),t=t.replace(/^(\d{1})(\d{3}).*/,"$1,$2")),t};t("#btnAddItem").click(function(e){t(".step-three #hint-error").addClass("hide"),t("#txtItens").val()&&t("#txtQtd").val()&&t("#txtPrice").val()&&a<50?(e.preventDefault(),a++,i(!0),l()):(e.preventDefault(),t("#txtItens").val()||t(".step-three .item-two li").addClass("has-error is-focused"),t("#txtQtd").val()||t(".step-three .item-five li").addClass("has-error is-focused"),t("#txtPrice").val()||t(".step-three .item-six li").addClass("has-error is-focused"))}),t(document).on("click","#btnEditItem",function(a){if(t(".step-three #hint-error").addClass("hide"),t("#txtQtd").val()&&t("#txtPrice").val()){a.preventDefault();let o="",p="",c="",f="",x="";o=t("#txtRefine").val()?t("#txtRefine").val():"-",p=t("#txtCards").val()?t("#txtCards").val():"-",c=t("#txtEnchants").val()?t("#txtEnchants").val():"-",f=t("#txtQtd").val()?t("#txtQtd").val():"-",x=t("#txtPrice").val()?t("#txtPrice").val():"-",e=function(t,e,a,d,i,s,r,l,o,p,c){return t[e].txtRefine=a,t[e].txtCards=d.replace(/,/g,"*"),t[e].txtEnchants=i.replace(/,/g,"*"),t[e].txtQtd=s+" un",t[e].txtPrice=n(r)+" Z",void 0===l||(t[e].txtItensId=l),void 0===o||(t[e].txtItensName=o),void 0===p||(t[e].offer=p),void 0===c||(t[e].sold=c),t}(e,d,o,p,c,f,x),l(),s(JSON.stringify(e)),t("div.steps.step-three div.union-group.item-two.form-group ul li").removeClass("hide"),t("div.steps.step-three div.union-group.item-two.form-group ul .editItem").remove(),t("#btnEditItem").remove(),t("#btnAddItem").removeClass("hide"),t("td.rowActionButtons").append("<a href='javascript:void(0);' class='btnActionDeleteRow'><i class='fas fa-trash-alt'></i></a>"),i=e,t("#tbBrief tr:nth-child("+((r=d)+2)+") td:nth-child(1)").empty().append(i[r].txtRefine),t("#tbBrief tr:nth-child("+(r+2)+") td:nth-child(5)").empty().append(i[r].txtCards.replaceAll("*","<br>")),t("#tbBrief tr:nth-child("+(r+2)+") td:nth-child(6)").empty().append(i[r].txtEnchants.replaceAll("*","<br>")),t("#tbBrief tr:nth-child("+(r+2)+") td:nth-child(7)").empty().append(i[r].txtQtd),t("#tbBrief tr:nth-child("+(r+2)+") td:nth-child(8)").empty().append(i[r].txtPrice)}else a.preventDefault(),t("#txtQtd").val()||t(".step-three .item-five li").addClass("has-error is-focused"),t("#txtPrice").val()||t(".step-three .item-six li").addClass("has-error is-focused");var i,r;t("#btnRenderSaved").prop("disabled",!1),t("#btnRenderSaved").removeClass("um-disabled")}),t(document).on("click","a.btnActionEditRow",function(){t("#btnRenderSaved").prop("disabled",!0),t("#btnRenderSaved").addClass("um-disabled"),d=t(this).closest("tr").index()-1,t("div.steps.step-three div.union-group.item-two.form-group ul li").addClass("hide"),t("div.steps.step-three div.union-group.item-two.form-group ul .editItem").remove(),t("div.steps.step-three div.union-group.item-two.form-group ul").append("<li class='value editItem'><span class='text'>"+e[d].txtItensName+"</span></li>"),t("#txtQtd").val(e[d].txtQtd.replace(" un","")),t("#txtPrice").val(e[d].txtPrice.replace(" Z","").replace(/,/g,"")),"-"!=e[d].txtRefine&&t("#txtRefine").val(e[d].txtRefine),"-"!=e[d].txtCards&&t("#txtCards").val(e[d].txtCards.replace("*",", ")),"-"!=e[d].txtEnchants&&t("#txtEnchants").val(e[d].txtEnchants.replace("*",", ")),t("#btnAddItem").addClass("hide"),t("a.btnActionDeleteRow").remove(),t("#btnEditItem").length||t("div #actionButtons").append('<button id="btnEditItem" class="sale-button wprc-submit sale-button-edit" type="button">Editar</button>')}),t(document).on("click","a.btnActionDeleteRow",function(){d=t(this).closest("tr").index()-1,a--,delete e[d];let s=JSON.stringify(e.filter(function(t){return"object"!=typeof t||Array.isArray(t)||Object.keys(t).length>0}));i(!1,s)}),t("#btnRenderSaved").click(function(e){e.preventDefault();let d=t("#txtSavedTableItem").val(),s=t("#txtCurrentJsonSalesItems"+d).val();a=JSON.parse(s).length,i(!1,s),t("#txtTabNiceName").val(t("#savedTables option[value='"+d+"']").text()),t.scroll(".union-group.item-six")}),t("#btnEditOffer").click(function(e){if(e.preventDefault(),t(".step-three #hint-error").addClass("hide"),t("#offer-form .step-brief .hint-error-div").addClass("hide"),t("#offer-form .step-three .hint-bellow-title.hint-error-div").addClass("hide"),t("#txtSavedTableItem").val()&&t("#txtPrice").val()&&parseInt(t("#txtPrice").val(),10)>0&&t("#txtChar").val()){d=t("#txtSavedTableItem").val();let e="",a=t(".table-sale-form-post tr#child-"+d+" td.detail td.child-value a").html().replace(/^(\d+).*/,"$1");e+='[{"txtCharName":"'+t("#txtChar").val()+'","txtItensId":"'+a+'","txtOffer":"'+n(t("#txtPrice").val())+' Z"}]',s(e,d),t("#tbBrief tr#"+a+"-"+d+" td.inputValue.txtOfferRow").html("<font color='#1ba4e2'><b>"+n(t("#txtPrice").val())+" Z</b></font>"),t("div.steps.step-three div.union-group.item-two.form-group ul li").removeClass("hide"),t("div.steps.step-three div.union-group.item-two.form-group ul .editItem").remove(),l()}else t("#txtChar").val()||t(".step-three .item-one-offer li").addClass("has-error is-focused"),t("#txtSavedTableItem").val()||t(".step-three .item-two li").addClass("has-error is-focused"),(!t("#txtPrice").val()||parseInt(t("#txtPrice").val(),10)<=0)&&(t(".step-three .item-three li").addClass("has-error is-focused"),t("#offer-form .step-three .hint-bellow-title.hint-error-div").removeClass("hide"))}),t(document).on("click","a.btnActionEditOfferRow",function(){t("#btnEditOffer").prop("disabled",!1),t("#btnEditOffer").removeClass("um-disabled"),t(".step-three #hint-error").addClass("hide"),t("#offer-form .step-brief .hint-error-div").addClass("hide"),t("#offer-form .step-three .hint-bellow-title.hint-error-div").addClass("hide"),t("#txtSavedTableItem").val(t(this).closest("tr").index()-1),t("div.steps.step-three div.union-group.item-two.form-group ul li").addClass("hide"),t("div.steps.step-three div.union-group.item-two.form-group ul .editItem").remove(),t("div.steps.step-three div.union-group.item-two.form-group ul").append("<li class='value editItem'><span class='text'>"+t(this).closest("tr").find(".txtItemName").html()+"</span></li>"),"-"!=t(this).closest("tr").find(".txtOfferRow").html()?t("#txtPrice").val(t(this).closest("tr").find(".txtOfferRow").html().replace(" Z","").replace(/,/g,"")):t("#txtPrice").val("0")}),t(document).on("click","a.btnActionDeleteOfferRow",function(){d=t(this).closest("tr").index()-1;let e=t(".table-sale-form-post tr#child-"+d+" td.detail td.child-value a").html().replace(/^(\d+).*/,"$1");t(".step-three #hint-error").addClass("hide"),t("#offer-form .step-brief .hint-error-div").addClass("hide"),t("#offer-form .step-three .hint-bellow-title.hint-error-div").addClass("hide"),t("#tbBrief tr#"+e+"-"+d+" td.inputValue.txtOfferRow").html("-"),t("#divBrief #txtSendBrief"+d).remove(),t("div.steps.step-three div.union-group.item-two.form-group ul li").removeClass("hide"),t("div.steps.step-three div.union-group.item-two.form-group ul .editItem").remove(),l()})});